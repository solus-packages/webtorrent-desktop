From 36af6f9a163a53a38adebfe34ab70a9261ed96df Mon Sep 17 00:00:00 2001
From: Joey Riches <josephriches@gmail.com>
Date: Wed, 24 Jul 2019 15:03:06 +0100
Subject: [PATCH 1/1] solbuild fixes

Signed-off-by: Joey Riches <josephriches@gmail.com>
---
 bin/package.js | 7 ++-----
 package.json   | 2 +-
 2 files changed, 3 insertions(+), 6 deletions(-)

diff --git a/bin/package.js b/bin/package.js
index edf00df..781b7d7 100755
--- a/bin/package.js
+++ b/bin/package.js
@@ -109,7 +109,7 @@ const all = {
 
   // Runs `npm prune --production` which remove the packages specified in
   // "devDependencies" before starting to package the app.
-  prune: true,
+  prune: false,
 
   // The Electron version that the app is built with (without the leading 'v')
   electronVersion: require('electron/package.json').version
@@ -175,7 +175,7 @@ const linux = {
   platform: 'linux',
 
   // Build ia32 and x64 binaries.
-  arch: ['ia32', 'x64']
+  arch: ['x64']
 
   // Note: Application icon for Linux is specified via the BrowserWindow `icon` option.
 }
@@ -530,9 +530,6 @@ function buildLinux (cb) {
     buildPath.forEach(function (filesPath) {
       const destArch = filesPath.split('-').pop()
 
-      if (argv.package === 'deb' || argv.package === 'all') {
-        tasks.push((cb) => packageDeb(filesPath, destArch, cb))
-      }
       if (argv.package === 'zip' || argv.package === 'all') {
         tasks.push((cb) => packageZip(filesPath, destArch, cb))
       }
diff --git a/package.json b/package.json
index 5a650ab..a6f9343 100644
--- a/package.json
+++ b/package.json
@@ -102,7 +102,7 @@
     "gh-release": "gh-release",
     "open-config": "node ./bin/open-config.js",
     "package": "node ./bin/package.js",
-    "prepublish": "npm run build",
+    "prepublish": "npm run build --unsafe-perm",
     "start": "npm run build && electron .",
     "test": "standard && depcheck --ignores=buble,nodemon,gh-release --ignore-dirs=build,dist && node ./bin/extra-lint.js",
     "test-integration": "npm run build && node ./test",
-- 
2.22.0

